<!DOCTYPE html>
<!-- ============================================
     P√ÅGINA HTML - FRONTEND DA PLAYLIST
     ============================================
     Este arquivo cria a interface visual da aplica√ß√£o
     √â como a "cara" da aplica√ß√£o, o que aparece na tela
-->

<html lang="pt-BR">
<head>
    <!-- ============================================
         CONFIGURA√á√ïES DA P√ÅGINA (Meta Tags)
         ============================================ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéµ Playlist API - Atividade 2</title>
    
    <!-- ============================================
         ESTILOS CSS (Apar√™ncia Visual)
         ============================================ -->
    <style>
        /* Reset b√°sico */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Corpo da p√°gina - tema escuro estilo Spotify */
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        /* Container principal */
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* T√≠tulo principal */
        h1 {
            color: #1DB954;          /* Verde Spotify */
            margin-bottom: 30px;
            text-align: center;
            font-size: 2.5em;
        }

        /* Se√ß√µes */
        .section {
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* T√≠tulos das se√ß√µes */
        .section h2 {
            color: #1DB954;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        /* Bot√µes */
        button {
            background: #1DB954;
            color: #000;
            border: none;
            padding: 12px 28px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #1ed760;
            transform: scale(1.05);
        }

        /* √Åreas de resultado */
        #resultado-musicas, #resultado-duracao, #resultado-extremos {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border-left: 4px solid #1DB954;
        }

        /* Cada item de m√∫sica */
        .musica-item {
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }

        .musica-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .musica-info {
            flex: 1;
        }

        .musica-nome {
            font-size: 1.1em;
            font-weight: bold;
            color: #fff;
        }

        .musica-artista {
            color: #b3b3b3;
            font-size: 0.9em;
        }

        .musica-duracao {
            color: #1DB954;
            font-weight: bold;
            font-size: 0.9em;
        }

        .musica-genero {
            background: rgba(29, 185, 84, 0.2);
            color: #1DB954;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            margin-left: 15px;
        }

        /* Mensagem de carregando */
        .loading {
            color: #1DB954;
            font-style: italic;
        }

        /* Mensagem de erro */
        .erro {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }

        /* Estat√≠stica grande */
        .stat-grande {
            font-size: 2em;
            color: #1DB954;
            font-weight: bold;
            text-align: center;
            margin: 15px 0;
        }

        /* Card de destaque */
        .card-destaque {
            background: linear-gradient(135deg, rgba(29, 185, 84, 0.2) 0%, rgba(29, 185, 84, 0.05) 100%);
            border: 1px solid rgba(29, 185, 84, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
            text-align: center;
        }

        .card-destaque h4 {
            color: #1DB954;
            margin-bottom: 10px;
        }

        .card-destaque .musica-nome {
            font-size: 1.3em;
        }
    </style>
</head>
<body>
    <!-- ============================================
         CONTE√öDO VISUAL DA P√ÅGINA
         ============================================ -->
    
    <div class="container">
        <h1>üéµ Playlist API</h1>

        <!-- ============================================
             SE√á√ÉO 1: Listar M√∫sicas
             ============================================ -->
        <div class="section">
            <h2>üìã 1. Lista de M√∫sicas</h2>
            <button onclick="carregarMusicas()">Carregar Playlist</button>
            <div id="resultado-musicas"></div>
        </div>

        <!-- ============================================
             SE√á√ÉO 2: Dura√ß√£o Total
             ============================================ -->
        <div class="section">
            <h2>‚è±Ô∏è 2. Dura√ß√£o Total da Playlist</h2>
            <button onclick="calcularDuracaoTotal()">Calcular Dura√ß√£o</button>
            <div id="resultado-duracao"></div>
        </div>

        <!-- ============================================
             EXERC√çCIO 5: Adicione aqui a Se√ß√£o 3!
             ============================================ -->

    </div>

    <!-- ============================================
         C√ìDIGO JAVASCRIPT
         ============================================ -->
    <script>
        // ============================================
        // CONFIGURA√á√ÉO DA URL DA API
        // ============================================
        const API_URL = 'http://localhost:3000';

        // ============================================
        // FUN√á√ÉO AUXILIAR: Formatar segundos em MM:SS
        // ============================================
        function formatarDuracao(segundos) {
            const min = Math.floor(segundos / 60);
            const seg = segundos % 60;
            // padStart(2, '0') = adiciona zero √† esquerda se tiver s√≥ 1 d√≠gito
            return `${min}:${seg.toString().padStart(2, '0')}`;
        }

        // ============================================
        // FUN√á√ÉO 1: Carregar Lista de M√∫sicas
        // ============================================
        async function carregarMusicas() {
            const resultadoDiv = document.getElementById('resultado-musicas');
            resultadoDiv.innerHTML = '<p class="loading">üéµ Carregando playlist...</p>';

            try {
                // Faz requisi√ß√£o para a API
                const response = await fetch(`${API_URL}/pega-musicas`);
                const data = await response.json();

                if (data.sucesso) {
                    let html = `<p style="color: #b3b3b3; margin-bottom: 15px;">
                        ${data.quantidade} m√∫sicas encontradas
                    </p>`;
                    
                    // Percorre cada m√∫sica e cria o HTML
                    data.musicas.forEach(musica => {
                        html += `
                            <div class="musica-item">
                                <div class="musica-info">
                                    <div class="musica-nome">${musica.nome}</div>
                                    <div class="musica-artista">${musica.artista}</div>
                                </div>
                                <span class="musica-genero">${musica.genero}</span>
                                <span class="musica-duracao">${formatarDuracao(musica.duracao)}</span>
                            </div>
                        `;
                    });
                    
                    resultadoDiv.innerHTML = html;
                } else {
                    resultadoDiv.innerHTML = '<p class="erro">Erro ao carregar m√∫sicas</p>';
                }
            } catch (error) {
                resultadoDiv.innerHTML = `<p class="erro">‚ùå Erro: ${error.message}. Verifique se o backend est√° rodando!</p>`;
            }
        }

        // ============================================
        // FUN√á√ÉO 2: Calcular Dura√ß√£o Total
        // ============================================
        async function calcularDuracaoTotal() {
            const resultadoDiv = document.getElementById('resultado-duracao');
            resultadoDiv.innerHTML = '<p class="loading">‚è±Ô∏è Calculando...</p>';

            try {
                const response = await fetch(`${API_URL}/duracao-total`);
                const data = await response.json();

                if (data.sucesso) {
                    resultadoDiv.innerHTML = `
                        <div class="stat-grande">
                            ${data.duracaoFormatada}
                        </div>
                        <p style="text-align: center; color: #b3b3b3;">
                            Total de ${data.totalMusicas} m√∫sicas | ${data.duracaoTotalSegundos} segundos
                        </p>
                    `;
                } else {
                    resultadoDiv.innerHTML = '<p class="erro">Erro ao calcular dura√ß√£o</p>';
                }
            } catch (error) {
                resultadoDiv.innerHTML = `<p class="erro">‚ùå Erro: ${error.message}</p>`;
            }
        }

        // ============================================
        // EXERC√çCIO 5: Adicione aqui a Fun√ß√£o 3!
        // ============================================

    </script>
</body>
</html>
